<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <meta charset="UTF-8">
    <title>Register - E-Commerce Store</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
<div class="nav-overlay" id="navOverlay" onclick="toggleMobileMenu()"></div>
   <nav class="navbar">
    <h1 onclick="window.location.href='/'">üõí E-Commerce Store</h1>
    
    <!-- Hamburger Button -->
    <button class="menu-toggle" id="menuToggle" onclick="toggleMobileMenu()">‚ò∞</button>
    
    <div class="nav-links" id="navLinks">
        <!-- Close Button -->
        
        
        <a href="/">Home</a>
        <a href="/web/admin" id="adminLink" style="display:none;">Dashboard</a>
        <a href="/web/products">Products</a>
        <a href="/web/cart">Cart (<span id="cartCount">0</span>)</a>
        <a href="/web/orders" id="ordersLink" style="display:none;">My Orders</a>
        <a href="/web/profile" id="profileLink" style="display:none;">Profile</a>
        
        <span id="userName"></span>
        <button id="logoutBtn" style="display:none;" onclick="logout()">Logout</button>
        <a href="/web/login" id="loginLink">Login</a>
        <a href="/web/register" id="registerLink">Register</a>
    </div>
</nav>

    <div class="form-container">
        <h2>Create Account</h2>
        <div id="message"></div>
        
        <form id="registerForm">
            <div class="form-group">
                <label>Full Name</label>
                <input type="text" id="name" required placeholder="Enter your name">
            </div>

            <div class="form-group">
                <label>Email</label>
                <input type="email" id="email" required placeholder="Enter your email">
            </div>

            <div class="form-group">
    <label>Password</label>
    <div class="password-wrapper">
        <input type="password" id="password" class="password-input" required minlength="6">
        <button type="button" class="password-toggle" onclick="togglePasswordVisibility('password', this)">üëÅÔ∏è‚Äçüó®Ô∏è</button>
    </div>
    <small style="color:#6b7280;">Minimum 6 characters</small>
</div>

<div class="form-group">
    <label>Confirm Password</label>
    <div class="password-wrapper">
        <input type="password" id="confirmPassword" class="password-input" required minlength="6">
        <button type="button" class="password-toggle" onclick="togglePasswordVisibility('confirmPassword', this)">üëÅÔ∏è‚Äçüó®Ô∏è</button>
    </div>
</div>

            <button type="submit" class="btn">Register</button>
        </form>

        <p style="text-align: center; margin-top: 1rem;">
            Already have an account? <a href="/web/login">Login here</a>
        </p>
    </div>

    <script>
    function togglePasswordVisibility(inputId, toggleBtn) {
        const input = document.getElementById(inputId);
        const icon = toggleBtn;
        
        if (input.type === 'password') {
            input.type = 'text';
            icon.textContent = 'üëÅÔ∏è';
        } else {
            input.type = 'password';
            icon.textContent = 'üëÅÔ∏è‚Äçüó®Ô∏è';
        }
    }
    
        function updateCartCount() {
            const cart = JSON.parse(localStorage.getItem('cart') || '[]');
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').textContent = count;
        }
        updateCartCount();

        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                password: document.getElementById('password').value
            };

            try {
                const response = await fetch('/api/auth/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });

                const data = await response.json();

                if (response.ok) {
                    localStorage.setItem('token', data.token);
                    localStorage.setItem('user', JSON.stringify(data));
                    window.location.href = '/';
                } else {
                    document.getElementById('message').innerHTML = 
                        '<div class="alert alert-error">' + (data.error || data.message || 'Registration failed') + '</div>';
                }
            } catch (error) {
                document.getElementById('message').innerHTML = 
                    '<div class="alert alert-error">Registration failed. Please try again.</div>';
            }
        });
        function toggleMobileMenu() {
            const navLinks = document.getElementById('navLinks');
            const overlay = document.getElementById('navOverlay');
            const menuToggle = document.getElementById('menuToggle');
            
            if (!navLinks || !overlay || !menuToggle) return;
            
            const isActive = navLinks.classList.contains('active');
            
            if (isActive) {
                // Close menu
                navLinks.classList.remove('active');
                overlay.classList.remove('active');
                menuToggle.textContent = '‚ò∞';
                menuToggle.style.fontSize = '1.8rem';
                document.body.style.overflow = 'auto';
            } else {
                // Open menu
                navLinks.classList.add('active');
                overlay.classList.add('active');
                menuToggle.textContent = '√ó';
                menuToggle.style.fontSize = '2.5rem';
                document.body.style.overflow = 'hidden';
            }
        }
        
        // Close menu when clicking a link
        document.addEventListener('DOMContentLoaded', function() {
            const navLinks = document.querySelectorAll('.nav-links a, .nav-links button');
            navLinks.forEach(link => {
                link.addEventListener('click', () => {
                    if (window.innerWidth <= 768) {
                        const menu = document.getElementById('navLinks');
                        const overlay = document.getElementById('navOverlay');
                        if (menu && menu.classList.contains('active')) {
                            toggleMobileMenu();
                        }
                    }
                });
            });
        });
        
        // Close menu on window resize
        window.addEventListener('resize', () => {
            if (window.innerWidth > 768) {
                const navLinks = document.getElementById('navLinks');
                const overlay = document.getElementById('navOverlay');
                const menuToggle = document.getElementById('menuToggle');
                
                if (navLinks) navLinks.classList.remove('active');
                if (overlay) overlay.classList.remove('active');
                if (menuToggle) {
                    menuToggle.textContent = '‚ò∞';
                    menuToggle.style.fontSize = '1.8rem';
                }
                document.body.style.overflow = 'auto';
            }
        });
    </script>
    <!-- Footer -->
<footer style="background:#1f2937;color:white;padding:3rem 2rem;margin-top:4rem;">
    <div style="max-width:1400px;margin:0 auto;">
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:3rem;margin-bottom:3rem;">
            <!-- Company Info -->
            <div>
                <h3 style="font-size:1.5rem;margin-bottom:1rem;font-weight:800;">üõí E-Commerce Store</h3>
                <p style="color:#9ca3af;line-height:1.6;">Your trusted online shopping destination for quality products at great prices.</p>
            </div>
            
            <!-- Quick Links -->
            <div>
                <h4 style="font-size:1.1rem;margin-bottom:1rem;font-weight:700;">Quick Links</h4>
                <ul style="list-style:none;padding:0;">
                    <li style="margin-bottom:0.5rem;"><a href="/" style="color:#9ca3af;text-decoration:none;transition:color 0.3s;" onmouseover="this.style.color='white'" onmouseout="this.style.color='#9ca3af'">Home</a></li>
                    <li style="margin-bottom:0.5rem;"><a href="/web/products" style="color:#9ca3af;text-decoration:none;transition:color 0.3s;" onmouseover="this.style.color='white'" onmouseout="this.style.color='#9ca3af'">Products</a></li>
                    <li style="margin-bottom:0.5rem;"><a href="/web/orders" style="color:#9ca3af;text-decoration:none;transition:color 0.3s;" onmouseover="this.style.color='white'" onmouseout="this.style.color='#9ca3af'">My Orders</a></li>
                    <li style="margin-bottom:0.5rem;"><a href="/web/profile" style="color:#9ca3af;text-decoration:none;transition:color 0.3s;" onmouseover="this.style.color='white'" onmouseout="this.style.color='#9ca3af'">Profile</a></li>
                </ul>
            </div>
            
            <!-- Customer Service -->
                    <div>
    <h4 style="font-size:1.1rem;margin-bottom:1rem;font-weight:700;">Customer Service</h4>
    <ul style="list-style:none;padding:0;">
        <li style="margin-bottom:0.5rem;"><a href="/web/contact" style="color:#9ca3af;text-decoration:none;transition:color 0.3s;" onmouseover="this.style.color='white'" onmouseout="this.style.color='#9ca3af'">Contact Us</a></li>
        <li style="margin-bottom:0.5rem;"><a href="/web/returns" style="color:#9ca3af;text-decoration:none;transition:color 0.3s;" onmouseover="this.style.color='white'" onmouseout="this.style.color='#9ca3af'">Returns & Refunds</a></li>
        <li style="margin-bottom:0.5rem;"><a href="/web/privacy" style="color:#9ca3af;text-decoration:none;transition:color 0.3s;" onmouseover="this.style.color='white'" onmouseout="this.style.color='#9ca3af'">Privacy Policy</a></li>
    </ul>
</div>
            
            <!-- Contact -->
            <div>
                <h4 style="font-size:1.1rem;margin-bottom:1rem;font-weight:700;">Get in Touch</h4>
                <p style="color:#9ca3af;margin-bottom:0.5rem;">üìß support@ecommerce.com</p>
                <p style="color:#9ca3af;margin-bottom:0.5rem;">üì± 1-800-SHOP-NOW</p>
                <p style="color:#9ca3af;">üìç 123 Commerce St, City, State 12345</p>
            </div>
        </div>
        
        <!-- Copyright Bar -->
        <div style="border-top:1px solid #374151;padding-top:2rem;text-align:center;">
            <p style="color:#9ca3af;margin-bottom:0.5rem;">
                ¬© <span id="currentYear"></span> E-Commerce Store. All rights reserved.
            </p>
            <p style="color:#6b7280;font-size:0.9rem;">
                Powered by Stripe | Secure Shopping Experience
            </p>
        </div>
    </div>
</footer>

<script>
    // Set current year automatically
    document.getElementById('currentYear').textContent = new Date().getFullYear();
</script>
    
</body>
</html>
